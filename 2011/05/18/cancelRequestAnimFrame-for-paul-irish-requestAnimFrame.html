<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>cancelRequestAnimationFrame() For Paul Irish requestAnimationFrame() on Jerome Etienne blog</title>
	<meta name="author" content="Jerome Etienne" />
	
	
	<!-- syntax highlighting CSS -->
	<link rel="stylesheet" href="/css/syntax.css" type="text/css" />
	<!-- Homepage CSS -->
	<link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
</head>
<body>
	
<style>
.announce {
	margin-bottom	: 2em;
	font-weight	: bold;	
	font-size	: 130%;
	background	: #020202;
	color		: #ccc;
	padding		: 15px;
	border-radius	: 20px;
	border		: solid;
	border-width	: 2px;
	border-color	: #888;
	text-shadow	: 0px 1px 0px #333;	
}
</style>

<div class="site">
	<div class="title">
		<a href="/">Jerome Etienne Notes</a>
		<div style="float: right;"> 
			<a href="http://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script> 
		</div>
	</div>
	<div class="announce">
		Just released <a href="/2011/04/20/pacmaze-v2-even-more-WebGL-in-pacman.html">Pacmaze</a> my first WebGL game!
		<a href="http://pacmaze.com">Check it out!</a>
	</div>
  
	<div id="post">
  <h1><a href=''>cancelRequestAnimationFrame() For Paul Irish requestAnimationFrame()</a></h1>
  <p class='meta'>
    2011-05-18
    
  </p>
  <p><a href="http://paulirish.com/">Paul Irish</a> recently
wrote <a href="http://paulirish.com/2011/requestanimationframe-for-smart-animating/">requestAnimationFrame for smart animating</a>.
It is a polyfill so people can start use requestAnimationFrame() today and still be future proof.</p>

<p>This post is about its counterpart,
<a href="http://webstuff.nfshost.com/anim-timing/Overview.html#cancelRequestAnimationFrame">cancelRequestAnimFrame()</a>.
It cancels a <a href="http://webstuff.nfshost.com/anim-timing/Overview.html#requestAnimationFrame">requestAnimationFrame()</a>,
like <a href="https://developer.mozilla.org/en/DOM/window.clearTimeout">clearTimeout</a>
cancels a <a href="https://developer.mozilla.org/en/DOM/window.setTimeout">setTimeout</a>.</p>

<h1>Step 1: how to get the code</h1>

<p>First include the <code>cancelRequestAnimFrame()</code> code in your page.</p>

<pre><code>window.cancelRequestAnimFrame = ( function() {
    return window.cancelAnimationFrame          ||
        window.webkitCancelRequestAnimationFrame    ||
        window.mozCancelRequestAnimationFrame       ||
        window.oCancelRequestAnimationFrame     ||
        window.msCancelRequestAnimationFrame        ||
        clearTimeout
} )();
</code></pre>

<p>Add <code>requestAnimFrame()</code> too. It is a slightly modified version of
<a href="http://paulirish.com/2011/requestanimationframe-for-smart-animating/">paul's</a>
to return setTimeout() handle.</p>

<pre><code>window.requestAnimFrame = (function(){
    return  window.requestAnimationFrame       || 
        window.webkitRequestAnimationFrame || 
        window.mozRequestAnimationFrame    || 
        window.oRequestAnimationFrame      || 
        window.msRequestAnimationFrame     || 
        function(/* function */ callback, /* DOMElement */ element){
            return window.setTimeout(callback, 1000 / 60);
        };
})();
</code></pre>

<h1>Step 2: how to use it</h1>

<p>Here is a possible way to use it.
<strong><em>Show, dont tell</em></strong>, here is a <a href="http://jsfiddle.net/ghjKC/3/">live demo</a> on jsfiddle</p>

<pre><code>// to store the request
var request;

// start and run the animloop
(function animloop(){
  render();
  request = requestAnimFrame(animloop, element);
})();

// cancelRequestAnimFrame to stop the loop in 1 second
setTimeout(function(){
    cancelRequestAnimFrame(request);                
}, 1*1000)
</code></pre>

<h1>About requestAnimationFrame</h1>

<p>In the past months, much has been done for web graphics. Among them,
<a href="http://webstuff.nfshost.com/anim-timing/Overview.html">requestAnimationFrame()</a>
is used to make smoother animation while not wasting useless
rescources when not visible.
The <a href="http://webstuff.nfshost.com/anim-timing/Overview.html">spec</a> is making good
progress, and <a href="http://dev.chromium.org/developers/design-documents/requestanimationframe-implementation">several</a>
<a href="https://developer.mozilla.org/en/DOM/window.mozRequestAnimationFrame">implementations</a> are already deployed.</p>

</div>

<div id="related">
	If you reached this point, maybe you want to share it:
	<a href="http://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
	<br/>	
	<br/>	
	<h2>Related Posts</h2>
	<ul class="posts">
		
			<li><span>15 Jul 2011</span> &raquo; <a href="/2011/07/15/threejs-installation.html">Three.js Installation</a></li>
		
			<li><span>10 Jul 2011</span> &raquo; <a href="/2011/07/10/javascript-class-inheritance-ala-vaporjs-in-3-lines.html">Javascript Class Inheritance ala vapor.js in 3 lines</a></li>
		
			<li><span>26 May 2011</span> &raquo; <a href="/2011/05/26/Parisjs-7-slides.html">Parisjs 7 slides</a></li>
		
	</ul>
</div>



  
	<div class="footer">
		<div class="credits">
			<p>
				<a class="extra" href="http://jetienne.com">Homepage</a>
				|
				<a class="extra" href="http://jetienne.com">Twitter</a>
			</p>
		</div>
	</div>
</div>

<!-- google analytic -->
<script type="text/javascript">	
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-4037844-18']);
	_gaq.push(['_trackPageview']);
	
	(function() {
	  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
 
<!-- follow me on twitter --> 
<a href="http://www.twitter.com/jerome_etienne"><img style="position: absolute; top: 10px; right: 10px; border: 0;" src="http://twitter-badges.s3.amazonaws.com/follow_me-c.png" alt="Follow jerome_etienne on Twitter"/></a>
<!-- github ribbon -->
<!--<a href="http://github.com/jeromeetienne"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://d3nwyuy0nl342s.cloudfront.net/img/ce742187c818c67d98af16f96ed21c00160c234a/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f677261795f3664366436642e706e67" alt="Fork me on GitHub"></a>
--><!-- twitter profile widget -->
<style>
#twitterProfileWidget {
	position: fixed;
	bottom	: 0px;
	right	: 0px;
}
</style>
<div id="twitterProfileWidget">
	<script src="http://widgets.twimg.com/j/2/widget.js"></script>
	<script>
return;
	new TWTR.Widget({
		version: 2,
		type: 'profile',
		rpp: 4,
		interval: 6000,
		width: 250,
		height: 300,
		theme: {
			shell: {
				background: '#00a0d1',
				color: '#ffffff'
			},
			tweets: {
				background: '#c0deed',
				color: '#333333',
				links: '#00a0d1'
			}
		},
		features: {
			scrollbar: false,
			loop: false,
			live: false,
			hashtags: true,
			timestamp: true,
			avatars: false,
			behavior: 'all'
		}
	}).render().setUser('jerome_etienne').start();
	</script>
</div>




</body>
</html>
